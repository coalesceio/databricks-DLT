fileVersion: 1
id: "368"
isDisabled: false
metadata:
  defaultStorageLocation: null
  error: null
  nodeMetadataSpec: |+
    capitalized: ldp
    short: ldp
    plural: Lakeflow Declarative Principles
    tagColor: '#35D491'

    deployStrategy: advanced
    isColumnResyncEnabled: true

    config:
        - groupName: General options
          items:
          
          - displayName: Type of Lakeflow Declarative Pipeline
            attributeName: DLTtype
            type: materializationSelector
            default: STREAMING TABLE
            options:
            - STREAMING TABLE
            enableIf: "true"  
          
          - displayName: Schedule refresh
            attributeName: schedulerefresh
            type: toggleButton

        - groupName: LDP Options
          items:

          - displayName: Read from files
            attributeName: readfiles
            type: toggleButton
            default: false

          - displayName: Include Columns Inferred
            attributeName: inccolumns
            type: toggleButton
            enableIf: "{% if config.readfiles %} true {% else %} false {% endif %}"
            default: false

          - displayName: File location
            attributeName: fileloc
            type: textBox
            enableIf: "{% if config.readfiles %} true {% else %} false {% endif %}"
            isRequired: false

          - displayName: File name/File pattern
            attributeName: filepat
            type: textBox
            enableIf: "{% if config.readfiles %} true {% else %} false {% endif %}"
            isRequired: false

          - displayName: File format
            attributeName: fileformat
            type: dropdownSelector
            options:
            - csv
            - json
            - parquet
            - avro
            - orc
            - text
            enableIf: "{% if config.readfiles %} true {% else %} false {% endif %}"
            isRequired: false
          
          - displayName: Delimiter
            attributeName: delimiter
            type: textBox
            enableIf: "{% if config.readfiles and config.fileformat == 'csv' %} true {% else %} false {% endif %}"
            isRequired: false
            
          - displayName: Header
            attributeName: header
            type: toggleButton
            enableIf: "{% if config.readfiles and config.fileformat == 'csv' %} true {% else %} false {% endif %}"
            isRequired: false
          
          - displayName: Table properties
            attributeName: tblproperties
            type: textBox
          
          - type: toggleButton
            displayName: Partition by 
            attributeName: partclause
            enableIf: "{% if config.readfiles %} false {% else %} true {% endif %}"

          - type: tabular
            displayName: Partition by
            attributeName: partitionclause
            columns:

            -  type: columnDropdownSelector
               displayName: Partition by
               attributeName: partname
               isRequired: false
            isRequired: false
            enableIf: "{% if (config.partclause) %} true {% else %} false {% endif %}"
          
          - type: toggleButton
            displayName: Table Constraints
            attributeName: tableconstraints
            default: false
            enableIf: "{% if config.readfiles == false and config.constraints == false %} true {% else %} false {% endif %}"

          - type: toggleButton
            displayName: Primary key
            attributeName: primary
            enableIf: "{% if (config.tableconstraints) %} true {% else %} false {% endif %}"

          - type: textBox
            displayName: Primary key Name
            attributeName: primarykeyname
            enableIf: "{% if (config.tableconstraints and config.primary) %} true {% else %} false {% endif %}"


          - type: tabular   
            displayName: Primary key columns
            attributeName: primarykeycon
            columns:

            -  type: columnDropdownSelector
               displayName: Columns
               attributeName: primarykey

            isRequired: false
            enableIf: "{% if (config.tableconstraints and config.primary) %} true {% else %} false {% endif %}"

          - type: toggleButton
            displayName: Foreign key
            attributeName: foreign
            enableIf: "{% if (config.tableconstraints) %} true {% else %} false {% endif %}"

          - type: textBox
            displayName: Foreign key Name
            attributeName: foreignkeyname
            enableIf: "{% if (config.tableconstraints and config.foreign) %} true {% else %} false {% endif %}"

          - type: textBox
            displayName: Parent table name
            attributeName: parentabname
            default: "ex:`<catalog>`.`<schema>`.`<tablename>`"
            enableIf: "{% if (config.tableconstraints and config.foreign) %} true {% else %} false {% endif %}"

          - type: tabular
            displayName: Foreign key columns
            attributeName: foreignkeycon
            columns:

            -  type: columnDropdownSelector
               displayName: Foreign key
               attributeName: foreignkey
          
            isRequired: false
            enableIf: "{% if (config.tableconstraints and config.foreign ) %} true {% else %} false {% endif %}"

          - type: toggleButton
            attributeName: constraints
            displayName: Other constraints
            default: false
            enableIf: "{%if config.readfiles == false and config.tableconstraints == false%}true {%else%} false {%endif%}"
            isRequired: false

          - type: tabular
            displayName: 'Constraints'
            attributeName: constraintsspec
            columns:

            -  type: columnDropdownSelector
               displayName: ColumnName
               attributeName: columnName
               isRequired: false
          
            -  type: textBox
               displayName: Expected Expression
               attributeName: sqlExpression
               default: "ex:<column_name> IS NOT NULL"
               isRequired: false
            
            -  type: dropdownSelector
               displayName: ON VIOLATION
               attributeName: onviolation
               default: DROP ROW
               options:
               - FAIL UPDATE
               - DROP ROW 
          
            isRequired: false
            enableIf: "{% if config.constraints %} true {% else %} false {% endif %}"

        - groupName: Schedule Options
          enableIf: "{% if (config.schedulerefresh ) %} true {% else %} false {% endif %}"
          items:

          - displayName: Task Schedule
            attributeName: schedulePeriodOption
            type: dropdownSelector
            options:
            - Periodic schedule
            - CRON
      
          - displayName: CRON string
            attributeName: cron
            type: textBox
            enableIf: "{% if (config.schedulePeriodOption =='CRON' ) %} true {% else %} false {% endif %}"

          - displayName: CRON TIME ZONE
            attributeName: crontz
            type: textBox
            enableIf: "{% if (config.schedulePeriodOption =='CRON' ) %} true {% else %} false {% endif %}"
          
          - displayName: Schedule refesh-time period
            attributeName: tp
            options:
            - EVERY HOURS
            - EVERY DAYS
            - EVERY WEEKS
            type: dropdownSelector
            enableIf: "{% if (config.schedulePeriodOption == 'Periodic schedule' and config.schedulePeriodOption !='CRON') %} true {% else %} false {% endif %}"

          - displayName: Specific interval of periodic refresh(integer value)
            type: label
            enableIf: "{% if (config.schedulePeriodOption == 'Periodic schedule' and config.schedulePeriodOption !='CRON') %} true {% else %} false {% endif %}"


          - displayName: HOUR OR HOURS 1 <= H <= 72  
                         DAY  OR DAYS 1<= D <= 31
                         WEEK OR WEEKS 1 <= W <= 8
            attributeName: tph
            type: textBox
            enableIf: "{% if (config.schedulePeriodOption == 'Periodic schedule' and config.schedulePeriodOption !='CRON') %} true {% else %} false {% endif %}"



name: LDP
type: NodeType
